# 쓰레드의 생성시간

쓰레드가 유지되는 쓰레드풀과 async에서 새 쓰레드를 생성하는 방식 중 후자의 비용이 더 비효율적일수 있다는 생각이 들어서 실험을 해보게 되었다.

물론 async도 내부적으로 풀을 가지고 있다고는 들었지만 사실 정확한 구현은 모르겠다. gcc까지 가기엔 너무 험난한 여정이다.

새 쓰레드를 만드는건 os에 의존적인걸로 알고있다. 윈도우의 경우는 2007년 책을 정리한 포스팅인 https://popcorntree.tistory.com/63 이 글을 보면 대략적으로 나와있다. 뭐 그건 os에 맡겨놓고 일단 윈도우에서 테스트할 예정이다.

test1 : ThreadPool. 출처는 https://modoocode.com/284
test2 : async로만 바꿈

Debug  
ThreadPool : 13초  
async : 24초  

Release  
ThreadPool : 3.6초  
async : 1.8초  

???

아직 잘 모르겠다. 디버그모드 할때만해도 납득이 갔는데 릴리즈 속도차이는 뭐지...

처음엔 스레드 수 차이인줄 알았는데(async는 갯수제한을 안했으므로) 내부적인 구현 최적화의 차이가 아닐까 생각이 든다. 뮤텍스보다 더 뛰어난 세마포어나 어떤 구현이 있을듯하다.