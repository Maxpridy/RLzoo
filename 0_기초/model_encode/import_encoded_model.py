import io
import base64
import torch

import in_file_model

model = in_file_model.Test1()

encoded_weights = b'UEsDBAAACAgAAAAAAAAAAAAAAAAAAAAAAAAQABIAYXJjaGl2ZS9kYXRhLnBrbEZCDgBaWlpaWlpaWlpaWlpaWoACY2NvbGxlY3Rpb25zCk9yZGVyZWREaWN0CnEAKVJxAShYCgAAAGZjMS53ZWlnaHRxAmN0b3JjaC5fdXRpbHMKX3JlYnVpbGRfdGVuc29yX3YyCnEDKChYBwAAAHN0b3JhZ2VxBGN0b3JjaApGbG9hdFN0b3JhZ2UKcQVYDQAAADIwNjMxODY5NDcxNTJxBlgDAAAAY3B1cQdLBHRxCFFLAEsCSwKGcQlLAksBhnEKiWgAKVJxC3RxDFJxDVgIAAAAZmMxLmJpYXNxDmgDKChoBGgFWA0AAAAyMDYzMTg2OTQ3MjQ4cQ9oB0sCdHEQUUsASwKFcRFLAYVxEoloAClScRN0cRRScRVYCgAAAGZjMi53ZWlnaHRxFmgDKChoBGgFWA0AAAAyMDYzMTg2OTQyNDQ4cRdoB0sEdHEYUUsASwJLAoZxGUsCSwGGcRqJaAApUnEbdHEcUnEdWAgAAABmYzIuYmlhc3EeaAMoKGgEaAVYDQAAADIwNjMxODY5NDQ0NjRxH2gHSwJ0cSBRSwBLAoVxIUsBhXEiiWgAKVJxI3RxJFJxJVgNAAAAb3V0cHV0LndlaWdodHEmaAMoKGgEaAVYDQAAADIwNjMxODY5NDI4MzJxJ2gHSwJ0cShRSwBLAUsChnEpSwJLAYZxKoloAClScSt0cSxScS1YCwAAAG91dHB1dC5iaWFzcS5oAygoaARoBVgNAAAAMjA2MzE4Njk0MjkyOHEvaAdLAXRxMFFLAEsBhXExSwGFcTKJaAApUnEzdHE0UnE1dX1xNlgJAAAAX21ldGFkYXRhcTdoAClScTgoWAAAAABxOX1xOlgHAAAAdmVyc2lvbnE7SwFzWAMAAABmYzFxPH1xPWg7SwFzWAMAAABmYzJxPn1xP2g7SwFzWAYAAABvdXRwdXRxQH1xQWg7SwFzdXNiLlBLBwgUx9L6vgIAAL4CAABQSwMEAAAICAAAAAAAAAAAAAAAAAAAAAAAABoAOgBhcmNoaXZlL2RhdGEvMjA2MzE4Njk0MjQ0OEZCNgBaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpC2YS+OscAPzH1NT+hkNu+UEsHCNVsEf0QAAAAEAAAAFBLAwQAAAgIAAAAAAAAAAAAAAAAAAAAAAAAGgAoAGFyY2hpdmUvZGF0YS8yMDYzMTg2OTQyODMyRkIkAFpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWqFUHD9Upjg+UEsHCB8AXswIAAAACAAAAFBLAwQAAAgIAAAAAAAAAAAAAAAAAAAAAAAAGgAwAGFyY2hpdmUvZGF0YS8yMDYzMTg2OTQyOTI4RkIsAFpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpae0baPlBLBwjNOdtTBAAAAAQAAABQSwMEAAAICAAAAAAAAAAAAAAAAAAAAAAAABoANABhcmNoaXZlL2RhdGEvMjA2MzE4Njk0NDQ2NEZCMABaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlqtYjM/GDdiPlBLBwhHsv/LCAAAAAgAAABQSwMEAAAICAAAAAAAAAAAAAAAAAAAAAAAABoAMABhcmNoaXZlL2RhdGEvMjA2MzE4Njk0NzE1MkZCLABaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWhs56z55dgE/u6ihvaJ8PD9QSwcI91h2XBAAAAAQAAAAUEsDBAAACAgAAAAAAAAAAAAAAAAAAAAAAAAaACgAYXJjaGl2ZS9kYXRhLzIwNjMxODY5NDcyNDhGQiQAWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaZ8lxvvbpaj5QSwcIUPhN0ggAAAAIAAAAUEsDBAAACAgAAAAAAAAAAAAAAAAAAAAAAAAPADsAYXJjaGl2ZS92ZXJzaW9uRkI3AFpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlozClBLBwjRnmdVAgAAAAIAAABQSwECAAAAAAgIAAAAAAAAFMfS+r4CAAC+AgAAEAAAAAAAAAAAAAAAAAAAAAAAYXJjaGl2ZS9kYXRhLnBrbFBLAQIAAAAACAgAAAAAAADVbBH9EAAAABAAAAAaAAAAAAAAAAAAAAAAAA4DAABhcmNoaXZlL2RhdGEvMjA2MzE4Njk0MjQ0OFBLAQIAAAAACAgAAAAAAAAfAF7MCAAAAAgAAAAaAAAAAAAAAAAAAAAAAKADAABhcmNoaXZlL2RhdGEvMjA2MzE4Njk0MjgzMlBLAQIAAAAACAgAAAAAAADNOdtTBAAAAAQAAAAaAAAAAAAAAAAAAAAAABgEAABhcmNoaXZlL2RhdGEvMjA2MzE4Njk0MjkyOFBLAQIAAAAACAgAAAAAAABHsv/LCAAAAAgAAAAaAAAAAAAAAAAAAAAAAJQEAABhcmNoaXZlL2RhdGEvMjA2MzE4Njk0NDQ2NFBLAQIAAAAACAgAAAAAAAD3WHZcEAAAABAAAAAaAAAAAAAAAAAAAAAAABgFAABhcmNoaXZlL2RhdGEvMjA2MzE4Njk0NzE1MlBLAQIAAAAACAgAAAAAAABQ+E3SCAAAAAgAAAAaAAAAAAAAAAAAAAAAAKAFAABhcmNoaXZlL2RhdGEvMjA2MzE4Njk0NzI0OFBLAQIAAAAACAgAAAAAAADRnmdVAgAAAAIAAAAPAAAAAAAAAAAAAAAAABgGAABhcmNoaXZlL3ZlcnNpb25QSwYGLAAAAAAAAAAeAy0AAAAAAAAAAAAIAAAAAAAAAAgAAAAAAAAAKwIAAAAAAACSBgAAAAAAAFBLBgcAAAAAvQgAAAAAAAABAAAAUEsFBgAAAAAIAAgAKwIAAJIGAAAAAA=='
decoded = base64.b64decode(encoded_weights)
buffer = io.BytesIO(decoded)
loaded_dict = torch.load(buffer)
model.load_state_dict(loaded_dict)

result = model(torch.tensor([1, 1], dtype=torch.float))
print(result)